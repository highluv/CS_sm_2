@startuml
start

:Получить filename, mode из main;

if (mode == 1 ?) then (да)
  :openMode = ios::out;
  note right
  Режим 1: создаём новый файл
  (перезаписываем существующий).
  end note
elseif (mode == 2 ?) then (да)
  :openMode = ios::app;
  note right
  Режим 2: дописываем в конец
  без изменения уже записанных строк.
  end note
else (нет)
  :Вывести "Invalid mode!";
  :return false;
  stop
endif

:Открыть ofstream file(filename, openMode);

if (file не открыт?) then (да)
  :Вывести "Cannot open file!";
  :return false;
  stop
endif

:i = 0;

while (i < contactsCount)
  :c = contacts[i];
  note right
  Берём контакт из глобального массива contacts[].
  end note

  :Сформировать строку
  "c.id;c.name;...;c.deleted";
  :Записать строку в файл;

  :i++;
endwhile

:Закрыть file;
:return true;
stop
@enduml
